@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@inject Microsoft.Extensions.Localization.IStringLocalizer<SharedResource> SharedLocalizer
@model EmcureCERI.Web.Models.DRFViewModels.DRFFormApproval
@{
	ViewData["Title"] = "DRFFinalApproval";
}

<div class="content-wrapper pt-3">


	<!-- Main content -->
	<section class="content">
		<div class="container-fluid">
			<!-- Small boxes (Stat box) -->
			<!-- Main row -->
			<div class="row">
				<section class="col-lg-12">
					<!-- Custom tabs (Charts with tabs)-->
					<div class="card">
						<div class="card-header">
							<h3 class="card-title">
								<i class="far fa-plus-square mr-2"></i> DRF Details
							</h3>
                            <div class="card-tools">
                                <a class="btn btn-primary" href="@Url.Action("DRFInitializationUpdation","DRFInitialization")"><i class="far fa-list-alt mr-1"></i>Edit</a>                                
                                <button class="btn btn-primary mr-3" onclick="javascript:window.history.back();"><i class="fas fa-undo mr-1"></i> Back</button>

                                <button type="button" class="btn btn-tool p-0 mr-3 expand1" data-card-widget="maximize">
                                    <i class="fas fa-expand"></i>
                                </button>
                                <button type="button" class="btn btn-tool" data-card-widget="collapse">
                                    <i class="fas fa-minus"></i>
                                </button>
                            </div>
						</div>
						<!-- /.card-header -->

						<div class="card-body">
                            <div class="min-max direct-chat-messages">

                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6  text-right">Country:</label>
                                        <div class="col-sm-6" id="DRFInitialization_CountryID"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">Generic Name:</label>
                                        <div class="col-sm-6" id="DRFInitialization_GenericName"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Brand Name:</label>
                                        <div class="col-sm-6" id="DRFInitialization_BrandName"></div>
                                    </div>
                                </div>
                                <div class="row">

                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">Trademark Approved:</label>
                                        <div class="col-sm-6" id="DRFInitialization_TreadmarkApprovedInternal"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Trademark suggested:</label>
                                        <div class="col-sm-6" id="DRFInitialization_TreadmarkSuggestedInternal"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Trademark:</label>
                                        <div class="col-sm-6" id="DRFInitialization_TreadmarkOwnerInternal"></div>
                                    </div>
                                </div>

                                <div class="row">

                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Form:</label>
                                        <div class="col-sm-6" id="DRFInitialization_Form"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">Strength:</label>
                                        <div class="col-sm-6" id="DRFInitialization_Strength"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Pack Size/s:</label>
                                        <div class="col-sm-6" id="DRFInitialization_PackSize"></div>
                                    </div>
                                </div>

                                <div class="row">

                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Pack Style:</label>
                                        <div class="col-sm-6" id="DRFInitialization_PackStyle"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Plant:</label>
                                        <div class="col-sm-6" id="DRFInitialization_Plant"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Product Type:</label>
                                        <div class="col-sm-6" id="DRFInitialization_ProductType"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Samples Required:</label>
                                        <div class="col-sm-6" id="DRFInitialization_Samples_Required"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">Remark:</label>
                                    </div>
                                    <div class="col-sm-6" id="DRFInitialization_Remark"></div>
                                </div>

                                <h4 class="text-divider d-none "><span>PIDF Details</span></h4>
                                <div class="row d-none">
                                    <div class="col-sm-4 row ">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">PIDF Attached : </label>
                                        <div class="col-sm-6" id="DRFInitialization_AttachedPIDF"></div>
                                    </div>
                                </div>

                                <div class="row d-none">
                                    <div class="col-sm-12 table-responsive">
                                        <table id="PIDFTable" class="table table-bordered table-striped table-hover" style="width:100%;">
                                            <thead>
                                                <tr>
                                                    <th>@SharedLocalizer["Id"].Value</th>
                                                    <th>@SharedLocalizer["Project Name"].Value</th>
                                                    <th>@SharedLocalizer["Strength"].Value</th>
                                                    <th>@SharedLocalizer["Patent Status"].Value</th>
                                                    <th>@SharedLocalizer["Continent"].Value</th>
                                                    <th>@SharedLocalizer["Country"].Value</th>
                                                    <th>@SharedLocalizer["Packing"].Value</th>
                                                    <th>@SharedLocalizer["Batch Size (In pack)"].Value</th>
                                                    <th>@SharedLocalizer["Pack Size"].Value</th>
                                                    <th>@SharedLocalizer["Cogs"].Value</th>
                                                    <th>@SharedLocalizer["Freight($)"].Value</th>
                                                    <th>@SharedLocalizer["Total CIF Cost($)"].Value</th>
                                                    <th>@SharedLocalizer["CIF Price Per Unit($)"].Value</th>
                                                    <th>@SharedLocalizer["CIF Price Per Pack($)"].Value</th>
                                                    <th>@SharedLocalizer["Profit Per Pack"].Value</th>
                                                    <th>@SharedLocalizer["Percent Cont"].Value</th>
                                                    <th>@SharedLocalizer["Contribution 3 yr"].Value</th>
                                                    <th>@SharedLocalizer["Cost of 3 Batches"].Value</th>
                                                    <th>@SharedLocalizer["R&D Cost($)"].Value</th>
                                                    <th>@SharedLocalizer["Filing Cost($)"].Value</th>
                                                    <th>@SharedLocalizer["Stability Cost($)"].Value</th>
                                                    <th>@SharedLocalizer["Total Invest($)"].Value</th>
                                                    <th>@SharedLocalizer["ROI"].Value</th>
                                                    @*<th>@SharedLocalizer["Project Status"].Value</th>*@

                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>



                                <h3 class="text-divider"><span>Regulated Details</span></h3>

                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Currency:</label>
                                        <div class="col-sm-6" id="DRFInitialization_Currency"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">Fees to be paid by:</label>
                                        <div class="col-sm-6" id="DRFInitialization_FeesToBePaidBy"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Registration Fee ($):</label>
                                        <div class="col-sm-6" id="DRFInitialization_RegistrationFees"></div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Mode of Fees Payment:</label>
                                        <div class="col-sm-6" id="DRFInitialization_ModeOfFeesPayment"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">MA Holder:</label>
                                        <div class="col-sm-6" id="DRFInitialization_MAHolder"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        @*<label class="col-sm-6 text-right">Proposed Marketing Status:</label>*@
                                        <label class="col-sm-6 text-right">Business Type:</label>
                                        <div class="col-sm-6" id="DRFInitialization_ProposedMarketingStatus"></div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">Shipping Port:</label>
                                        <div class="col-sm-6" id="DRFInitialization_ShippingPort"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Mode of Shipment:</label>
                                        <div class="col-sm-6" id="DRFInitialization_ModeOfShipment"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Incoterms:</label>
                                        <div class="col-sm-6" id="DRFInitialization_Incoterms"></div>
                                    </div>

                                </div>

                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Dossier submitted to MoH by:</label>
                                        <div class="col-sm-6" id="DRFInitialization_DossierSubmittedToMOHBy"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">Owner of Registration:</label>
                                        <div class="col-sm-6" id="DRFInitialization_OwnerOfRegistration"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">CDA Excecuted:</label>
                                        <div class="col-sm-6" id="DRFInitialization_AvailabilityofCDA"></div>
                                    </div>
                                    @*<div class="col-sm-4"></div>*@
                                </div>

                                <div class="row">

                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">TS Excecuted:</label>
                                        <div class="col-sm-6" id="DRFInitialization_TSExcecuted"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">DA Excecuted:</label>
                                        <div class="col-sm-6" id="DRFInitialization_DAExcecuted"></div>
                                    </div>
                                    @*<div class="col-sm-4"></div>*@
                                </div>
                                @*Forecast Units (Packs)*@

                                <h3 class="text-divider"><span>Market Details</span></h3>
                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Current / Proposed Market Size:</label>
                                        <div class="col-sm-6" id="DRFInitialization_MarketSize"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">3 Yr. CAGR:</label>
                                        <div class="col-sm-6" id="DRFInitialization_ThreeYearCAGR"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Number of Current Players:</label>
                                        <div class="col-sm-6" id="DRFInitialization_NumberOfCurrentPlayer"></div>
                                    </div>

                                </div>

                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Expected Mkt. Value Growth(%):</label>
                                        <div class="col-sm-6" id="DRFInitialization_ExpectedMarketValueGrowth"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Innovator Brand:</label>
                                        <div class="col-sm-6" id="DRFInitialization_InnovatorBrand"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">Innovator Name:</label>
                                        <div class="col-sm-6" id="DRFInitialization_InnavotorName"></div>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Top Brand:</label>
                                        <div class="col-sm-6" id="DRFInitialization_FirstBrand"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">MS Top Brand:</label>
                                        <div class="col-sm-6" id="DRFInitialization_MSFirstBrand"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">2nd Brand:</label>
                                        <div class="col-sm-6" id="DRFInitialization_SecondBrand"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <label class="col-sm-6 text-right">MS 2nd Brand:</label>
                                        <div class="col-sm-6" id="DRFInitialization_MSSecondBrand"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">3rd Brand:</label>
                                        <div class="col-sm-6" id="DRFInitialization_ThirdBrand"></div>
                                    </div>
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">MS 3rd Brand:</label>
                                        <div class="col-sm-6" id="DRFInitialization_MSThirdBrand"></div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-4 row">
                                        <!-- text input -->
                                        <label class="col-sm-6 text-right">Partner or Potential Partner:</label>
                                        <div class="col-sm-6" id="DRFInitialization_Partner"></div>
                                    </div>
                                    <div class="col-sm-4"></div>
                                    <div class="col-sm-4"></div>
                                </div>



                                <h3 class="text-divider"><span>Value in USD only</span></h3>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <!-- text input -->
                                        <div class="form-group">
                                            <label>Value in USD only</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group text-center">
                                            <label>Year 1</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group text-center">
                                            <label>Year 2</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group text-center">
                                            <label>Year 3</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <!-- text input -->
                                        <div class="form-group">
                                            <label>Forecast Units (Packs) ($)</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group " id="DRFInitialization_FirstYearForecastUnitsPacks"></div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_SecondYearForecastUnitsPacks"></div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_ThirdYearForecastUnitsPacks"></div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-sm-3">
                                        <!-- text input -->
                                        <div class="form-group">
                                            <label>Forecast CIF (for Emcure) ($)</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_FirstYearForecastCIF"></div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_SecondYearForecastCIF"></div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_ThirdYearForecastCIF"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <!-- text input -->
                                        <div class="form-group">
                                            <label>Forecast Value (Emcure) ($)</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_FirstYearForecastValue"></div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_SecondYearForecastValue"></div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_ThirdYearForecastValue"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <!-- text input -->
                                        <div class="form-group">
                                            <label>Forecast Price to Patient (for our brand)($)</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_FirstYearForecastPriceToPatient"></div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_SecondYearForecastPriceToPatient"></div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_ThirdYearForecastPriceToPatient"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <!-- text input -->
                                        <div class="form-group">
                                            <label>Order frequency:</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_OrderFrequency"></div>
                                    </div>
                                    <div class="col-sm-3"></div>
                                    <div class="col-sm-3"></div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <!-- text input -->
                                        <div class="form-group">
                                            <label>No. of Shipments:</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group" id="DRFInitialization_NoofShipments"></div>
                                    </div>
                                    <div class="col-sm-3"></div>
                                    <div class="col-sm-3"></div>
                                </div>

                                <hr />
                                <div class="row">
                                    <div class="col-sm-3 ">
                                        <label>Name to whom dossier to be sent:</label>
                                    </div>
                                    <div class="col-sm-3" id="DRFInitialization_NameDossierSend"></div>
                                    <div class="col-sm-3 ">
                                        <label>Address to whom dossier to be sent:</label>

                                    </div>
                                    <div class="col-sm-3" id="DRFInitialization_AddressDossierSend"></div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-3 ">
                                        <label>Email to whom dossier to be sent:</label>
                                    </div>
                                    <div class="col-sm-3" id="DRFInitialization_EmailDossierSend"></div>

                                    @*<div class="col-sm-3 ">
                                        <label>Country Code:</label>
                                    </div>
                                    <div class="col-sm-3" id="DRFInitialization_CountryCode"></div>*@

                                    <div class="col-sm-3 ">
                                        <label>Phone Number to whom dossier to be sent:</label>
                                    </div>
                                    <div class="col-sm-3" id="DRFInitialization_PhoneDossierSend"></div>
                                </div>
                                <div class="row">                                    
                                    <div class="col-sm-3 ">
                                        <label>Strategy Alignment:</label>
                                    </div>
                                    <div class="col-sm-3" id="DRFInitialization_StrategyAlignment"></div>
                                    <div class="col-sm-3">
                                        <label>Exception Explained:</label>
                                    </div>
                                    <div class="col-sm-3" id="DRFInitialization_ExceptionExplained"></div>
                                </div>

                            </div>
							<!-- /.card-body -->
						</div>
						<!-- /.card -->





					</div>


					<div class="row">
						<section class="col-lg-12">
							<!-- Custom tabs (Charts with tabs)-->
							<div class="card">
								<div class="card-header">
									<h3 class="card-title">
										<i class="far fa-plus-square mr-2"></i> Approval Summary Table
									</h3>
								</div>
								<!-- /.card-header -->

								<div class="card-body">
									<table class="table table-bordered">
										<tr>
											<th>Responsible</th>
											<th>Name</th>
											<th>Date</th>
										</tr>
										<tr>
											<td><strong>Dossier raised by</strong></td>
											<td><div id="DossierCreatedName"></div></td>
											<td><div id="DossierCreatedDateTime"></div></td>
										</tr>
										<tr>
											<td><strong>Dossier checked by Country Manager</strong></td>
											<td><div id="CountryManagerApprovalName"></div></td>
											<td><div id="CountryManagerApprovalDateTime"></div></td>
										</tr>
										<tr>
											<td><strong>Dossier checked by Ho</strong></td>
											<td><div id="LineManagerApprovalName"></div></td>
											<td><div id="LineManagerApprovalDateTime"></div></td>
										</tr>
										<tr>
											<td><strong>HOD DRF Approval</strong></td>
											<td><div id="HODofDossierApprovalName"></div></td>
											<td><div id="HODofDossierApprovalDateTime"></div></td>
										</tr>
										<tr>
											<td><strong>HOD dossier prep. Approval</strong></td>
											<td><div id="HODofDossierApprovalName1"></div></td>
											<td><div id="HODofDossierApprovalDateTime1"></div></td>
										</tr>


									</table>

								</div>
							</div>


							<!-- /.card-body -->
							<!-- /.card -->

						</section>
					</div>



					<div class="row">
						<section class="col-lg-12">
							<!-- Custom tabs (Charts with tabs)-->
							<div class="card">
								<div class="card-header">
									<h3 class="card-title">
										<i class="far fa-plus-square mr-2"></i> Approval
									</h3>
								</div>
								<!-- /.card-header -->
								<form method="post" name="Approval" onsubmit="return SubmitApprovalForm(this)">
									<div class="card-body">
										@*@Html.HiddenFor(Model => Model.InitializationID, (object)ViewBag.IniInitializationID)*@
										@Html.HiddenFor(Model => Model.InitializationID)
										@Html.HiddenFor(Model => Model.UserRole)
										<div class="row">
											<div class="col-sm-3">
												<!-- text input -->
												<label>Do you want to approve this DRF<span style="color:red">*</span> :</label>
											</div>
											<div class="col-sm-3 row">
												<div class="form-group text-center">
													<div class="form-group required">
														<div class="icheck-primary d-inline mr-5">
															@*@Html.RadioButtonFor(model => model.SubmissionChecklist, "General", new { id = "General" })*@
															@Html.RadioButton("DRFApproval", true, true, htmlAttributes: new { @class = "radiobuttons", id = "Approved", @onchange = "CheckRadioBox()" })
															<label for="Approved">
																Approved
															</label>
														</div>

														<div class="icheck-primary d-inline">
															@*@Html.RadioButtonFor(model => model.SubmissionChecklist, "NationalFormat", new { id = "NationalFormat" })*@
															@Html.RadioButton("DRFApproval", false, false, htmlAttributes: new { @class = "radiobuttons", id = "Rejected", @onchange = "CheckRadioBox()" })

															<label for="Rejected">
																Rejected
															</label>
														</div>
														@Html.ValidationMessageFor(model => model.DRFApproval, "", new { @class = "text-danger" })
													</div>
												</div>
											</div>
											<div class="col-sm-1">
												<label>Comment:</label>
												@*@Html.LabelFor(model => model.Comment, new { @class = "control-label"  })*@
											</div>
											<div class="col-sm-5">
												<div class="form-group">
													@*<textarea name="comment" class="form-control" rows="3"></textarea>*@
													@Html.TextAreaFor(model => model.Comment, new { @class = "form-control", @readonly = true })
													@*@Html.ValidationMessageFor(model => model.Comment, "", new { @class = "text-danger" })*@
													<small class="text-danger" id="Comment_Error"></small>
												</div>
											</div>
										</div>

									</div>
									<div class="card-footer text-center mb-3">
										@if (User.IsInRole("Country Manager") || User.IsInRole("Line Manager") || User.IsInRole("HOD Of Dossier") || User.IsInRole("Prescriber"))
										{
											<button type="submit" class="btn btn-primary">@SharedLocalizer["Save"].Value</button>
										}

										@*<button type="button" class="btn btn-primary">Reset</button>*@
										<a class="btn btn-danger" asp-area="" asp-controller="DRFInitialization" asp-action="Index">@SharedLocalizer["Cancel"].Value</a>
									</div>
								</form>
								<!-- /.card-body -->
							</div>
							<!-- /.card -->

						</section>
					</div>

				</section>

			</div>


		</div>

		<!-- /.container-fluid -->
	</section>
	<!-- /.content -->
</div>
<script>
    var PIDFInitializationID = 0;
    var PIDFCountryID = 0;
    var currentRole = '@HttpContextAccessor.HttpContext.Session.GetString("CurrentUserRole")';
    //console.log(currentRole);
    $('#InitializationID').val(@ViewBag.DRFApprovalInitializationID);
    $('#UserRole').val(currentRole);
    $(document).ready(function () {
    $('#loading').show();
    var data = { InitializationID: '@ViewBag.DRFApprovalInitializationID' };

    $.ajax({
        type: "POST",
        url: '@Url.Action("GetFilledIPMANSCMRADetails", "DRFInitialization")/',
        //contentType: "application/json; charset=utf-8",
        dataType: "json",
        data: data,
		success: function (response) {
			$('#loading').hide();				
			//Initialization Details
			PIDFInitializationID = response.data.initializationDetails.initializationID;
			PIDFCountryID = response.data.initializationDetails.countryID;
			$('#CountryID').val(response.data.initializationDetails.countryID);
			$('#DRFInitialization_CountryID').text(response.data.initializationDetails.country);
			$('#DRFInitialization_GenericName').text(response.data.initializationDetails.genericName);
			$('#DRFInitialization_BrandName').text(response.data.initializationDetails.brandName);
			if (response.data.initializationDetails.treadmarkApprovedInternal == true) {
				$('#DRFInitialization_TreadmarkApprovedInternal').text("Yes");
			}
			else {
				$('#DRFInitialization_TreadmarkApprovedInternal').text("No");
			}
			$('#DRFInitialization_TreadmarkSuggestedInternal').text(response.data.initializationDetails.treadmarkSuggestedInternal);
			$('#DRFInitialization_TreadmarkOwnerInternal').text(response.data.initializationDetails.treadmarkOwnerInternal);
			$('#DRFInitialization_Form').text(response.data.initializationDetails.form);
			$('#DRFInitialization_Strength').text(response.data.initializationDetails.strength);
			$('#DRFInitialization_PackSize').text(response.data.initializationDetails.packSize);
			$('#DRFInitialization_PackStyle').text(response.data.initializationDetails.packStyle);
            $('#DRFInitialization_Plant').text(response.data.initializationDetails.plant);
            $('#DRFInitialization_ProductType').text(response.data.initializationDetails.productType);
			$('#DossierTemplateID').val(response.data.initializationDetails.dossierTemplateID);
			$('#DRFInitialization_Currency').text(response.data.initializationDetails.currency);
			if (response.data.initializationDetails.registrationFees != null) {
				$('#DRFInitialization_RegistrationFees').text(response.data.initializationDetails.registrationFees.toFixed(2));
			}

            $('#DRFInitialization_FeesToBePaidBy').text(response.data.initializationDetails.feesToBePaidBy);
            $('#DRFInitialization_ModeOfFeesPayment').text(response.data.initializationDetails.modeOfFeesPayment);
            $('#DRFInitialization_MAHolder').text(response.data.initializationDetails.maHolder);
            $('#DRFInitialization_ProposedMarketingStatus').text(response.data.initializationDetails.proposedMarketingStatus);
            $('#DRFInitialization_ShippingPort').text(response.data.initializationDetails.shippingPort);
            $('#DRFInitialization_ModeOfShipment').text(response.data.initializationDetails.modeOfShipment);
            $('#DRFInitialization_Incoterms').text(response.data.initializationDetails.incoterms);
            $('#DRFInitialization_DossierSubmittedToMOHBy').text(response.data.initializationDetails.dossierSubmittedToMOHBy);
            $('#DRFInitialization_OwnerOfRegistration').text(response.data.initializationDetails.ownerOfRegistration);

            if (response.data.initializationDetails.availabilityofCDA == true) {
                $('#DRFInitialization_AvailabilityofCDA').text("Yes");
            }
            else {
                $('#DRFInitialization_AvailabilityofCDA').text("No");
            }

            if (response.data.initializationDetails.tsExcecuted == true) {
                $('#DRFInitialization_TSExcecuted').text("Yes");
            }
            else {
					$('#DRFInitialization_TSExcecuted').text("No");
			}

			if (response.data.initializationDetails.daExcecuted == true) {
				$('#DRFInitialization_DAExcecuted').text("Yes");
			}
			else {
				$('#DRFInitialization_DAExcecuted').text("No");
			}

            $('#DRFInitialization_MarketSize').text(response.data.initializationDetails.marketSize.toFixed(2));
            $('#DRFInitialization_ThreeYearCAGR').text(response.data.initializationDetails.threeYearCAGR);
            $('#DRFInitialization_NumberOfCurrentPlayer').text(response.data.initializationDetails.numberOfCurrentPlayer);
            $('#DRFInitialization_ExpectedMarketValueGrowth').text(response.data.initializationDetails.expectedMarketValueGrowth.toFixed(2));
            $('#DRFInitialization_InnovatorBrand').text(response.data.initializationDetails.innovatorBrand);
            $('#DRFInitialization_InnavotorName').text(response.data.initializationDetails.innavotorName);
            $('#DRFInitialization_FirstBrand').text(response.data.initializationDetails.firstBrand);
            $('#DRFInitialization_MSFirstBrand').text(response.data.initializationDetails.msFirstBrand);
            $('#DRFInitialization_SecondBrand').text(response.data.initializationDetails.secondBrand);
            $('#DRFInitialization_MSSecondBrand').text(response.data.initializationDetails.msSecondBrand);
            $('#DRFInitialization_ThirdBrand').text(response.data.initializationDetails.thirdBrand);
            $('#DRFInitialization_MSThirdBrand').text(response.data.initializationDetails.msThirdBrand);
            $('#DRFInitialization_Partner').text(response.data.initializationDetails.partner);
            $('#DRFInitialization_FirstYearForecastUnitsPacks').text(response.data.initializationDetails.firstYearForecastUnitsPacks.toFixed(2));
            $('#DRFInitialization_SecondYearForecastUnitsPacks').text(response.data.initializationDetails.secondYearForecastUnitsPacks.toFixed(2));
            $('#DRFInitialization_ThirdYearForecastUnitsPacks').text(response.data.initializationDetails.thirdYearForecastUnitsPacks.toFixed(2));
            $('#DRFInitialization_FirstYearForecastPriceToPatient').text(response.data.initializationDetails.firstYearForecastPriceToPatient.toFixed(2));
            $('#DRFInitialization_SecondYearForecastPriceToPatient').text(response.data.initializationDetails.secondYearForecastPriceToPatient.toFixed(2));
            $('#DRFInitialization_ThirdYearForecastPriceToPatient').text(response.data.initializationDetails.thirdYearForecastPriceToPatient.toFixed(2));
            $('#DRFInitialization_FirstYearForecastCIF').text(response.data.initializationDetails.firstYearForecastCIF.toFixed(2));
            $('#DRFInitialization_SecondYearForecastCIF').text(response.data.initializationDetails.secondYearForecastCIF.toFixed(2));
            $('#DRFInitialization_ThirdYearForecastCIF').text(response.data.initializationDetails.thirdYearForecastCIF.toFixed(2));
            $('#DRFInitialization_FirstYearForecastValue').text(response.data.initializationDetails.firstYearForecastValue.toFixed(2));
            $('#DRFInitialization_SecondYearForecastValue').text(response.data.initializationDetails.secondYearForecastValue.toFixed(2));
            $('#DRFInitialization_ThirdYearForecastValue').text(response.data.initializationDetails.thirdYearForecastValue.toFixed(2));
            $('#DRFInitialization_OrderFrequency').text(response.data.initializationDetails.orderFrequency);
            $('#DRFInitialization_NoofShipments').text(response.data.initializationDetails.noofShipmnets);
            $('#DRFInitialization_NameDossierSend').text(response.data.initializationDetails.nameDossierSend);

            $('#DRFInitialization_EmailDossierSend').text(response.data.initializationDetails.emailDossierSend);
			$('#DRFInitialization_PhoneDossierSend').text(response.data.initializationDetails.phoneDossierSend);

            $('#DRFInitialization_AddressDossierSend').text(response.data.initializationDetails.addressDossierSend);
            if (response.data.initializationDetails.strategyAlignment == true) {
                    $('#DRFInitialization_StrategyAlignment').text("Yes");
            }
            else {
                    $('#DRFInitialization_StrategyAlignment').text("No");
            }
            $('#DRFInitialization_ExceptionExplained').text(response.data.initializationDetails.exceptionExplained);
            $('#DRFInitialization_Comment').text(response.data.initializationDetails.initialApproveRejectComment);

			$('#DRFInitialization_Remark').text(response.data.initializationDetails.remark);
			if (response.data.initializationDetails.isSamples_Required == true) {
                $('#DRFInitialization_Samples_Required').text(response.data.initializationDetails.samples_Required);
            }
            else {
                $('#DRFInitialization_Samples_Required').text("No");
            }

            getPIDFList();

            $('#DossierCreatedName').text(response.data.drfApprovalDetails.drfCreatedName);
            $('#DossierCreatedDateTime').text(convertDDMMYYY(response.data.drfApprovalDetails.drfCreatedDate.split('T')[0]) );

            if (response.data.drfApprovalDetails.cmCreatedDate != null) {

                if (response.data.drfApprovalDetails.drfCreatedName == response.data.drfApprovalDetails.lmApprovalName) {
                    $('#CountryManagerApprovalName').text("-")
                }
                else {
                    $('#CountryManagerApprovalName').text(response.data.drfApprovalDetails.cmApprovalName);
                    $('#CountryManagerApprovalDateTime').text(convertDDMMYYY(response.data.drfApprovalDetails.cmCreatedDate.split('T')[0]));
                }                   
            }

            if (response.data.drfApprovalDetails.lmCreatedDate != null) {
                $('#LineManagerApprovalName').text(response.data.drfApprovalDetails.lmApprovalName);
                $('#LineManagerApprovalDateTime').text(convertDDMMYYY(response.data.drfApprovalDetails.lmCreatedDate.split('T')[0]) );
            }
            if (response.data.drfApprovalDetails.hodApprovalName != null) {
                    $('#HODofDossierApprovalName').text(response.data.drfApprovalDetails.hodApprovalName);
                    $('#HODofDossierApprovalDateTime').text(convertDDMMYYY(response.data.drfApprovalDetails.hodCreatedDate.split('T')[0]) );
            }
        },
        failure: function () {

        }
    });

    var dataTable = $('#PIDFTable').DataTable({
        responsive: false,
        lengthChange: false,
        autoWidth: false,
        paging: false,
        searching: false,
        sort: false,
        "bInfo": false,
        columnDefs: [
            { responsivePriority: 1, targets: -5 },
            { responsivePriority: 1, targets: -3 },
            { responsivePriority: 100, targets: -4 }
        ],

        language: {
            "emptyTable": "@SharedLocalizer["No data available in table"].Value",
            "info": "@SharedLocalizer["Showing _START_ to _END_ of _TOTAL_ entries"].Value",
            "infoEmpty":"@SharedLocalizer["Showing 0 to 0 of 0 entries"].Value",
            "infoFiltered":"@SharedLocalizer["(filtered from _MAX_ total entries)"].Value",
            "lengthMenu":"@SharedLocalizer["Show _MENU_ entries"].Value",
            "loadingRecords": "@SharedLocalizer["Loading..."].Value",
            "processing": "@SharedLocalizer["Processing..."].Value",
            "search": "@SharedLocalizer["Search"].Value",
            "zeroRecords":"@SharedLocalizer["No matching records found"].Value",
            "paginate": {
                "first":"@SharedLocalizer["First"].Value",
                "last":"@SharedLocalizer["Last"].Value",
                "next": "@SharedLocalizer["Next"].Value",
                "previous":"@SharedLocalizer["Previous"].Value"
            },
        }
    });

    getPIDFList = function () {
        //$('#loaderContainer').show();
        var data = {"DRFID":PIDFInitializationID,"CountryID":PIDFCountryID};
             

        $.ajax({
            type: "POST",
            url: '@Url.Action("AttachedPIDFDetails", "DRFInitialization")/',
            //contentType: "application/json; charset=utf-8",
            dataType: "json",
            data:data,
            success: function (response) {
                $('#loading').hide();
                var jsonObject = response.data;

                if (jsonObject.length!=0 ) {
                    $('#DRFInitialization_AttachedPIDF').text("Yes");
                }
                else {
                    $('#DRFInitialization_AttachedPIDF').text("No");
                }

                var result = jsonObject.map(function (item) {
                    var result = [];

                    result.push(item.pidfNo);
                    result.push(item.projectorProductName);
                    result.push(item.strengths);
                    result.push(item.patentStatus);
                    result.push(item.continentName);
                    result.push(item.countryName);
                    result.push(item.packing);
                    result.push(item.batchSize);
                    result.push(item.packSize);
                    result.push(item.cogs);
                    result.push(item.freight);
                    result.push(item.totalCIFCost);
                    result.push(item.cifPricePerUnit);
                    result.push(item.cifPricePerPack);
                    result.push(item.profitPerPack);
                    result.push(item.percentCont);
                    result.push(item.contributionThreeYear);
                    result.push(item.costofThreeBatches);
                    result.push(item.randDCost);
                    result.push(item.filingCost);
                    result.push(item.stabilityCost);
                    result.push(item.totalInvest);
                    result.push(item.roi);                    
                    return result;
                });
                dataTable.clear();
                dataTable.rows.add(result); // add to DataTable instance
                dataTable.draw();
            },
            failure: function () {
                $("#PIDFTable").append('@SharedLocalizer["Error when fetching data please contact administrator"].Value');
            }
        });
    }

    });

    function SubmitApprovalForm(form) {

		if ($('[id="Rejected"]:checked').val() === 'False' && ($('#Comment').val() == '' || $('#Comment').val() == null || $('#Comment').val() == undefined )) {
			$('#Comment_Error').text('The Comment field is required');
			return false;
		}

        var url= "/DRFInitialization/Index";
         $.validator.unobtrusive.parse(form);
         $('#InitializationID').val(@ViewBag.IniInitializationID);

        if ($(form).valid()) {
            $('#loading').show();
            $.ajax({
                type : "POST",
                url : '@Url.Action("UpdateDRFApprovals", "DRFInitialization")/',//form.action,
                data : $(form).serialize(),
                success: function (result) {
                    $('#loading').hide();
                    if (result.data === "success") {                            
                        openCommonModal('successModal modal-sm', '@Html.Raw(SharedLocalizer["Success"].Value)', '@Html.Raw(SharedLocalizer["DRF data submitted."].Value)', true);
                        setTimeout(function(){ location.href = url; }, 2000);
                    }
                    else {
                        openCommonModal('alertModal modal-sm', '@SharedLocalizer["Error"].Value', result.message, false);
                    }
                }
            });
        }
        return false;
    }

    function convertDDMMYYY(tempDate) {
        return tempDate.split('-')[2] + '-' + tempDate.split('-')[1] + '-' + tempDate.split('-')[0];
    }

	function CheckRadioBox() {
		var data = $("input[name='DRFApproval']:checked").val();

		if (data == 'True') {
            $('#Comment').prop("readonly", true);
            $('#Comment_Error').empty();
		}
		else {
            $('#Comment').prop("readonly", false);
		}
	}

</script>